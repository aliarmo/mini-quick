## PROJECT INTRODUCTION
实现一个高性能小程序框架，可以自动缓存数据，容灾，预加载等

## TARGET
0. [solved]杜绝页面不必要的setData
    -- 解决方法
        -- 源数据源保存一份(这个用于数据上报，翻页等，提供一个get和set，便于存取)，
        -- 提取出来需要渲染的data一份
1. [solved]自动缓存接口请求成功数据，失败的时候自动使用缓存数据
    -- 解决方法
        -- 是否启用cache，启用啥样的cache，内存还是localStorage
        -- 缓存key的选取
2. [solved]使用缓存数据渲染首屏，在去拉取接口，diff更新首屏数据------适用于数据不经常变更场景
    -- 解决方法
        -- 页面name做key
3. [solved]预加载其他的页面数据，小程序就是一个单页，咋们可以预加载其他的tab页面数据
    -- 解决方法
        -- preload方式+一个take和put
4. [solved]目前预加载的做法是：
    -- 调页面的数据请求方法，区分三种场景，预加载的首屏、非预加载首屏、翻页
        -- 如果是预加载的首屏，取出源数据源中用于渲染的state，put源数据源和state
        -- 如果是非预加载的首屏，取出源数据源中用于渲染的state，保存源数据源和setData state
        -- 如果是翻页，从获取的数据中获取渲染state，跟原有的state进行从concat，然后setData，同样更新源数据源
    -- 进入页面的处理也分预加载场景和非预加载场景

## 接触场景的工程化，如小程序场景，如何工程化
1. 技术选型，对比市面框架，根据业务需求需要选择，没有最好只有最适合自己的
2. 框架能力补齐：
    -- 构建
    -- 状态管理
    -- 路由管理
3. 团队编码规范，组件编码规范，css编码规范，js编码规范，目录风格，commit规范

## 参考
1. [小程序原理](https://developers.weixin.qq.com/community/develop/article/doc/000a4c1620c188f3adf7db9ab5b413)

## 开发工业化
1. PC web、桌面客户端和h5页面工业化----单页
  -- autonode方式走服务端渲染，登录态相关，走bu路由，非登陆态相关，走biu路由，后着有cdn缓存
    -- 申请autoid
    -- 填写路由
    -- 开发模板，业务逻辑，css，数据源(backup)，静态页面备份
        -- 开发模板遵循模板规范，vue模板规范，es6模板规范
        -- 业务js使用eslint
    -- 使用tv进行构建，打包发布到测试环境
    -- pc web的测试，体验配置hosts，需要在指定APP打开h5页面那就麻烦了
        -- APP内调试h5方式
            -- vConsole，简单，但是只能console.log，并且发布的时候还要去除掉，也不方便
            -- 通过USB，使用chrome调试，这个可以打断点，功能强，但是经常出问题，很难成功走完流程
            -- **所以缺一个通用的远程调试工具，可在各大APP内调试**
  -- 优化点
    -- 是否可以有个none hosts方案
        -- 提供一个页面工具，微信打开获取这个参与者的id，可存放在cookie里面，有效期设置很长
        -- 参与者申请体验，由开发或者产品加这个id到无极，跟autoid关联
        -- autonode程序包放在外网机器上，由Nginx根据cookie中这个id进行鉴权
    -- autoid和路由可以放在tv做
2. PC web、桌面客户端和h5页面工业化----多页

3. 小程序工业化（小程序迁移到其他平台流程规范）
  -- 目前工业化流程
      -- 申请账号，申请appid，下载开发者工具
      -- 用这个appid在开发者工具新建项目，会生成脚手架
      -- 在vscode或者其他代码编辑器编码
      -- 开发者工具预览，扫码真机预览，调试，开发完成，自测完成，上传体验版，发邮件提测，开发效率跟开发者工具的易用性息息相关
          -- 开发者工具实用功能
              -- 编译打包
              -- 预览
              -- 断点调试
      -- 测试同学扫码测试，过机型，修bug，继续上传体验版，测试
      -- 测试通过，合并到主干，提审，发布-------**这一步很容易出错，没合并主干就发布了，需要规范下**
4. 一端转多端工业化
目前腾讯视频小程序现状：微信、QQ、QQ浏览器
**由一端转化为多端，这一块缺流程的工业化**
-- 新平台如果能兼容以前语法最好，不行的话最好官方提供语法转换工具，次之自己实现一个这样的工具
-- 不同端的代码要放在不同分支，不要根据环境变量来维护同一套代码
-- 新特性测试成功后最好马上合并到其他分支，如果合并有冲突，便于解决

4. Native开发工业化(用js来做移动原生应用开发)

## 一个产品的技术诞生
1. 产品做好调研，提需求单，做v1.0.0
2. 开发接到需求单，决定整体架构？
    -- 市面上是否有合适框架
    -- 是否需要根据业务需要调整或者扩展框架
    -- 搭建项目架子
        -- 请求器
        -- 数据上报
        -- 构建，最好支持热重载，包含打包、发布
3. 需求细节打磨

## 组内框架
1. 单页服务端渲染（jQuery或者同构）：autonode，通用路由，通用cgi，通用模板(给不用同构的场景使用)，每次遇到问题就只能问维护的童鞋，体验不好，一些小众的功能还不知道怎么写
2. 多页服务端渲染：glama

## 假设没有组内的这些流程、框架，你如何做开发
1. PC、客户端和h5单页面
2. PC、客户端和h5多页面
3. 小程序
4. native


## CI(continuous integration)
1. 持续集成
2. 持续交付
3. 持续部署
